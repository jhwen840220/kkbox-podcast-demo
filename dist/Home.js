"use strict";(self.webpackChunkkkbox_podcast_demo=self.webpackChunkkkbox_podcast_demo||[]).push([[268],{5829:(e,n,t)=>{t.r(n),t.d(n,{default:()=>S});var o=t(6252),l=t(3577);const s={class:"m-l-md m-b-xs fz-30 fz-bold"};var a=t(2262),c=t(894),i=t(8903);var d=t(8810);const r={class:"m-l-md"},u={class:"fz-16 fz-bold"},p={class:"m-t-lg fz-14"};var h=t(7484),m=t.n(h),f=t(8397);const g={name:"EpisodeCard",props:{title:{type:String,default:""},pubDate:{type:String,default:""},imgSrc:{type:String,default:""},duration:{type:String,default:""}},components:{LazyLoadImage:f.Z},setup(e){const n=(0,c.oR)();return{channelInfo:(0,a.Fl)((()=>n.getters.channelInfo)),episodeDuration:(0,a.Fl)((()=>(0,i.eo)(e.duration))),pubDatetime:(0,a.Fl)((()=>m()(e.pubDate).format("YYYY-MM-DD")))}}};var y=t(3744);const v={$style:{"episode-card":"EpisodeCard_episode-card-n7CFL"}},_={name:"EpisodeList",components:{EpisodeCard:(0,y.Z)(g,[["render",function(e,n,t,s,a,c){const i=(0,o.up)("LazyLoadImage");return(0,o.wg)(),(0,o.iD)("div",{class:(0,l.C_)([e.$style["episode-card"],"m-b-md p-md d-flex"])},[(0,o.Wm)(i,{src:t.imgSrc,alt:t.title,width:"75",height:"75"},null,8,["src","alt"]),(0,o._)("div",r,[(0,o._)("p",u,(0,l.zw)(t.title),1),(0,o._)("p",p,(0,l.zw)(s.pubDatetime)+" · 總長度: "+(0,l.zw)(s.episodeDuration),1)])],2)}],["__cssModules",v]])},props:{shouldchannelInfoSticky:{type:Boolean,default:!1}},setup(){const e=(0,d.tv)(),n=(0,c.oR)(),t=(0,a.Fl)((()=>n.getters.episodeList)),l=(0,a.qj)({data:[],count:0}),s=e=>Array.from(e).map((e=>({episodeId:e[0],...e[1]}))),i=e=>{const n=s(e);l.count=n.length>20?20:n.length,l.data=n.slice(0,l.count)};(0,o.bv)((()=>{t.value&&i(t.value)})),(0,o.YP)((()=>t.value),(e=>{i(e)}));const r=(0,a.iH)(null),u=(0,a.iH)(!1),p=()=>{const e=s(t.value),n=r.value.children.length,a=r.value.children[n-2];!u.value&&a.offsetTop-window.pageYOffset<500&&l.count<e.length&&(u.value=!0,l.count=l.count+(e.length-l.count>20?20:e.length-l.count),l.data=e.slice(0,l.count),(0,o.Y3)((()=>{u.value=!1})))};return(0,o.YP)(r,(()=>{document.addEventListener("scroll",p)})),(0,o.Jd)((()=>{document.removeEventListener("scroll",p)})),{currentEpisodeList:l,episodeListRef:r,goToEpisode:n=>{e.push({path:`/episode/${n}`})}}}},k={$style:{"episode-section-sticky":"EpisodeList_episode-section-sticky-gsXyp"}},I={name:"HomeContainer",components:{EpisodeList:(0,y.Z)(_,[["render",function(e,n,t,s,a,c){const i=(0,o.up)("EpisodeCard");return s.currentEpisodeList.data.length?((0,o.wg)(),(0,o.iD)("section",{key:0,class:(0,l.C_)(t.shouldchannelInfoSticky?e.$style["episode-section-sticky"]:""),ref:"episodeListRef"},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(s.currentEpisodeList.data,((e,n)=>((0,o.wg)(),(0,o.j4)(i,{key:n,imgSrc:e.imgSrc,title:e.title,pubDate:e.pubDate,duration:e.duration,onClick:n=>s.goToEpisode(e.episodeId)},null,8,["imgSrc","title","pubDate","duration","onClick"])))),128))],2)):(0,o.kq)("",!0)}],["__cssModules",k]]),LazyLoadImage:f.Z},setup(){const e=(0,c.oR)(),n=(0,a.iH)(!1),t=(0,a.iH)(null);return(0,o.bv)((()=>{(0,i.Sr)({target:t.value,callback:e=>{n.value=!(e[0].intersectionRatio>.5)},options:{root:null,threshold:.5}})})),{channelInfoRef:t,shouldchannelInfoSticky:n,channelInfo:(0,a.Fl)((()=>e.getters.channelInfo))}}},b={$style:{observer:"Home_observer-M29sS","channel-section":"Home_channel-section-yn0ba","channel-section-small":"Home_channel-section-small-Gfylr","channel-logo":"Home_channel-logo-afpBm","channel-logo-small":"Home_channel-logo-small-vqgst"}},S=(0,y.Z)(I,[["render",function(e,n,t,a,c,i){const d=(0,o.up)("LazyLoadImage"),r=(0,o.up)("EpisodeList");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",{ref:"channelInfoRef",class:(0,l.C_)([e.$style.observer,"position-absolute"])},null,2),(0,o._)("section",{class:(0,l.C_)([e.$style["channel-section"],"p-md d-flex",a.shouldchannelInfoSticky?[e.$style["channel-section-small"],"position-sticky p-t-md align-items-center"]:["align-items-end"]])},[(0,o._)("div",{class:(0,l.C_)([e.$style["channel-logo"],a.shouldchannelInfoSticky?[e.$style["channel-logo-small"]]:[]])},[(0,o.Wm)(d,{src:a.channelInfo.imgSrc,alt:a.channelInfo.name,width:a.shouldchannelInfoSticky?75:150,height:a.shouldchannelInfoSticky?75:150},null,8,["src","alt","width","height"])],2),(0,o._)("p",s,(0,l.zw)(a.channelInfo.name),1)],2),(0,o.Wm)(r,{shouldchannelInfoSticky:a.shouldchannelInfoSticky},null,8,["shouldchannelInfoSticky"])],64)}],["__cssModules",b]])}}]);