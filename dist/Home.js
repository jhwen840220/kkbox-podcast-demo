"use strict";(self.webpackChunkkkbox_podcast_demo=self.webpackChunkkkbox_podcast_demo||[]).push([[268],{8464:(e,n,l)=>{l.r(n),l.d(n,{default:()=>S});var t=l(6252),o=l(3577);const s={class:"m-l-md m-b-xs fz-30 fz-bold"};var a=l(2262),i=l(894),c=l(8903);var d=l(8810);const r={class:"m-l-md"},u={class:"fz-16 fz-bold"},p={class:"m-t-lg fz-14"};var h=l(7484),m=l.n(h),f=l(5722);const g={name:"EpisodeCard",props:{title:{type:String,default:""},pubDate:{type:String,default:""},imgSrc:{type:String,default:""},duration:{type:String,default:""}},components:{LazyLoadImage:f.Z},setup(e){const n=(0,i.oR)();return{channelInfo:(0,a.Fl)((()=>n.getters.channelInfo)),episodeDuration:(0,a.Fl)((()=>(0,c.eo)(e.duration))),pubDatetime:(0,a.Fl)((()=>m()(e.pubDate).format("YYYY-MM-DD")))}}};var v=l(3744);const y={$style:{"episode-card":"EpisodeCard_episode-card-n7CFL"}},_={name:"EpisodeList",components:{EpisodeCard:(0,v.Z)(g,[["render",function(e,n,l,s,a,i){const c=(0,t.up)("LazyLoadImage");return(0,t.wg)(),(0,t.iD)("div",{class:(0,o.C_)([e.$style["episode-card"],"m-b-md p-md d-flex"])},[(0,t.Wm)(c,{src:l.imgSrc,alt:l.title,width:"75",height:"75"},null,8,["src","alt"]),(0,t._)("div",r,[(0,t._)("p",u,(0,o.zw)(l.title),1),(0,t._)("p",p,(0,o.zw)(s.pubDatetime)+" · 總長度: "+(0,o.zw)(s.episodeDuration),1)])],2)}],["__cssModules",y]])},props:{shouldchannelInfoSticky:{type:Boolean,default:!1}},setup(){const e=(0,d.tv)(),n=(0,i.oR)(),l=(0,a.Fl)((()=>n.getters.episodeList)),o=(0,a.iH)(0),s=(0,a.iH)([]),c=e=>Array.from(e).map((e=>({episodeId:e[0],...e[1]}))),r=e=>{const n=c(e);o.value=n.length>20?20:n.length,s.value=n.slice(0,o.value)};(0,t.bv)((()=>{l.value&&r(l.value)})),(0,t.YP)((()=>l.value),(e=>{r(e)}));const u=(0,a.iH)(null),p=(0,a.iH)(!1),h=()=>{const e=c(l.value),n=u.value.children.length,a=u.value.children[n-2];!p.value&&a.offsetTop-window.pageYOffset<500&&o.value<e.length&&(p.value=!0,o.value=o.value+(e.length-o.value>20?20:e.length-o.value),s.value=e.slice(0,o.value),(0,t.Y3)((()=>{p.value=!1})))};return(0,t.YP)(u,(()=>{document.addEventListener("scroll",h)})),(0,t.Jd)((()=>{document.removeEventListener("scroll",h)})),{currentEpisodeList:s,episodeListRef:u,goToEpisode:n=>{e.push({path:`/episode/${n}`})}}}},k={$style:{"episode-section-sticky":"EpisodeList_episode-section-sticky-gsXyp"}},I={name:"HomeContainer",components:{EpisodeList:(0,v.Z)(_,[["render",function(e,n,l,s,a,i){const c=(0,t.up)("EpisodeCard");return s.currentEpisodeList.length?((0,t.wg)(),(0,t.iD)("section",{key:0,class:(0,o.C_)(l.shouldchannelInfoSticky?e.$style["episode-section-sticky"]:""),ref:"episodeListRef"},[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(s.currentEpisodeList,((e,n)=>((0,t.wg)(),(0,t.j4)(c,{key:n,imgSrc:e.imgSrc,title:e.title,pubDate:e.pubDate,duration:e.duration,onClick:n=>s.goToEpisode(e.episodeId)},null,8,["imgSrc","title","pubDate","duration","onClick"])))),128))],2)):(0,t.kq)("",!0)}],["__cssModules",k]]),LazyLoadImage:f.Z},setup(){const e=(0,i.oR)(),n=(0,a.iH)(!1),l=(0,a.iH)(null);return(0,t.bv)((()=>{(0,c.Sr)({target:l.value,callback:e=>{n.value=!(e[0].intersectionRatio>.5)},options:{root:null,threshold:.5}})})),{channelInfoRef:l,shouldchannelInfoSticky:n,channelInfo:(0,a.Fl)((()=>e.getters.channelInfo))}}},b={$style:{observer:"Home_observer-M29sS","channel-section":"Home_channel-section-yn0ba","channel-section-small":"Home_channel-section-small-Gfylr","channel-logo":"Home_channel-logo-afpBm","channel-logo-small":"Home_channel-logo-small-vqgst"}},S=(0,v.Z)(I,[["render",function(e,n,l,a,i,c){const d=(0,t.up)("LazyLoadImage"),r=(0,t.up)("EpisodeList");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t._)("div",{ref:"channelInfoRef",class:(0,o.C_)([e.$style.observer,"position-absolute"])},null,2),(0,t._)("section",{class:(0,o.C_)([e.$style["channel-section"],"p-md d-flex",a.shouldchannelInfoSticky?[e.$style["channel-section-small"],"position-sticky p-t-md align-items-center"]:["align-items-end"]])},[(0,t._)("div",{class:(0,o.C_)([e.$style["channel-logo"],a.shouldchannelInfoSticky?[e.$style["channel-logo-small"]]:[]])},[(0,t.Wm)(d,{src:a.channelInfo.imgSrc,alt:a.channelInfo.name,width:a.shouldchannelInfoSticky?75:150,height:a.shouldchannelInfoSticky?75:150},null,8,["src","alt","width","height"])],2),(0,t._)("p",s,(0,o.zw)(a.channelInfo.name),1)],2),(0,t.Wm)(r,{shouldchannelInfoSticky:a.shouldchannelInfoSticky},null,8,["shouldchannelInfoSticky"])],64)}],["__cssModules",b]])}}]);